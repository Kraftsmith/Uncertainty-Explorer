<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cynefin Framework Assessment</title>
    <link rel="stylesheet" href="common-styles.css">
    <style>
        /* Specific button styles if different from common-styles.css */
        /* These are ID-specific, so they remain here or could be classes in common if reused */
        #reset-btn {
            background-color: var(--danger-color, #e74c3c);
        }
         #reset-btn:hover {
            background-color: var(--danger-dark-color, #c0392b);
        }
        #complicated {
            background-color: #002A53; /* Complicated domain specific background */
        }
        @media (max-width: 768px) {
            /* .summary-section and .question-container responsive styles are in common-styles.css */
            /* Cynefin specific responsive adjustments */
            .group-title {
                font-size: 1.2em; /* Slightly smaller on mobile */
            }
            .cynefin-chart-container { /* Target the correct class */
                height: 400px; 
            }
            .domain-label, .domain-approach {
                font-size: 0.75em; 
            }
            .quadrant-name {
                font-size: 1.3em;
            }
        }
         @media (max-width: 480px) {
            .cynefin-chart-container { /* Target the correct class */
                height: 380px;
            }
            /* .quadrant-name, .domain-label, .domain-approach responsive styles are in common-styles.css if made generic */
            /* Or kept here if highly specific to Cynefin's chart implementation */
            .quadrant-name {
                font-size: 1.1em;
            }
             .domain-label, .domain-approach {
                font-size: 0.7em; 
            }
            .group-title { font-size: 1.1em; }
        }
    </style>
</head>
<body>
    <div class="section">
        <h1 class="section-title">Cynefin Framework Assessment</h1>
        <p>Evaluate your situation across key dimensions to determine the appropriate decision-making approach. Answer the following questions based on your current context.</p>
        <!-- Progress Tracker for Cynefin -->
        <div class="stacey-progress-tracker"> <!-- Reusing Stacey's tracker style for now -->
            <div class="step active" data-panel-id="decision-panel">Decision Factors</div>
            <div class="step-connector"></div>
            <div class="step" data-panel-id="cause-effect-panel">Cause & Effect Factors</div>
        </div>

        <!-- This div will host the question sections generated by the component -->
        <!-- It will now contain panels -->
        <div id="cynefin-question-panels-wrapper"></div>
    </div>

    <div class="section">
        <h2 class="section-title">Assessment Results. Cynefin Framework.</h2>
        
        <div class="chart-container" id="cynefin-chart-container">
            <div id="complex" class="quadrant">
                <span class="quadrant-name">Complex</span>
                <div class="domain-label" style="top: 45%;">Unknown Unknowns</div>
                <div class="domain-approach" style="top: 60%;">
                    PROBE → SENSE → RESPOND<br>Emergent Practice
                </div>
            </div>
            <div id="complicated" class="quadrant">
                <span class="quadrant-name">Complicated</span>
                <div class="domain-label" style="top: 45%;">Known Unknowns</div>
                <div class="domain-approach" style="top: 60%;">
                    SENSE → ANALYSE → RESPOND<br>Good Practice
                </div>
            </div>
            <div id="chaotic" class="quadrant">
                <span class="quadrant-name">Chaotic</span>
                <div class="domain-label" style="top: 45%;">Cause and Effect Unclear</div>
                <div class="domain-approach" style="top: 60%;">
                    ACT → SENSE → RESPOND<br>Novel Practice
                </div>
            </div>
            <div id="clear" class="quadrant">
                <span class="quadrant-name">Clear</span>
                <div class="domain-label" style="top: 45%;">Known Knowns</div>
                <div class="domain-approach" style="top: 60%;">
                    SENSE → CATEGORISE → RESPOND<br>Best Practice
                </div>
            </div>
            <div id="disorder" class="quadrant"><span class="quadrant-name">Disorder</span></div>
        </div>
        
        <div class="summary-section" style="justify-content: center;"> <!-- Changed class for consistency and centered -->
            <div class="score-box">
                <div>Determined Domain</div>
                <div class="score-value" id="current-domain">-</div>
            </div>
        </div>
          <div style="margin-top: 30px; text-align: center;">
            <button id="save-btn">Save and Next</button>
            <button id="reset-btn" style="margin-left: 15px;">Reset</button>
            <div style="margin-top: 15px;">
                <button id="test-complex-btn" style="background-color: #3498db; margin-right: 10px;">Test Complex</button>
                <button id="test-complicated-btn" style="background-color: #3498db;">Test Complicated</button>
            </div>
        </div>
    </div>
   
    <script>
        const CYNEFIN_LOCAL_STORAGE_KEY = 'cynefinFrameworkAssessmentResults_v3';

        // --- Integrated cynefinQuestionsData ---
        const cynefinQuestionsData = {
            decision: [
                { id: "q1_exp_needed", text: "How much experimentation is needed?" },
                { id: "q2_exp_consensus", text: "How much expert consensus exists?" },
                { id: "q3_urg_act", text: "How urgent is the need to act?" },
                { id: "q4_novel_aspects", text: "How often do novel aspects emerge?" },
                { id: "q5_stake_aligned", text: "How aligned are stakeholders?" },
                { id: "q6_tol_failure", text: "What is the tolerance for failure?" }
            ],
            causeEffect: [
                { id: "q7_ce_clarity", text: "How clear are the cause-and-effect relationships?" },
                { id: "q8_best_prac_exist", text: "To what extent do best practices exist?" },
                { id: "q9_pred_outcomes", text: "How predictable are the outcomes?" },
                { id: "q10_hist_data", text: "How much historical data is available?" },
                { id: "q11_unexp_outcomes", text: "How frequently do unexpected outcomes occur?" },
                { id: "q12_sys_boundaries", text: "How well understood are the system boundaries?" },
                { id: "q13_cons_results", text: "How consistent are results when repeating actions?" }
            ]
        };

        // --- Main Script Logic ---
        // UPDATED Thresholds based on the latest image (image_c43706.png)
        const questionDomainThresholds = {
            "How much experimentation is needed?":                { Complex: [6.5, 9],  Complicated: [4, 6.5], Chaotic: [9, 10],  Clear: [1, 4] },
            "How much expert consensus exists?":                  { Complex: [1.5, 3],  Complicated: [3, 6.5], Chaotic: [0, 1.5],  Clear: [6.5, 10] },
            "How urgent is the need to act?":                     { Complex: [5, 8],    Complicated: [3, 5],   Chaotic: [8, 9],    Clear: [0, 3] }, // Updated
            "How often do novel aspects emerge?":                 { Complex: [7, 9],    Complicated: [4, 7],   Chaotic: [9, 10],  Clear: [0, 4] },
            "How aligned are stakeholders?":                      { Complex: [1.5, 3],  Complicated: [3, 7],   Chaotic: [0, 1.5],  Clear: [7, 10] },
            "What is the tolerance for failure?":                 { Complex: [1.5, 3],  Complicated: [3, 7],   Chaotic: [0, 1.5],  Clear: [7, 10] },
            "How clear are the cause-and-effect relationships?":  { Complex: [1.5, 3.5],Complicated: [3.5, 7], Chaotic: [0, 1.5],  Clear: [7, 10] },
            "To what extent do best practices exist?":              { Complex: [1.5, 3.5],Complicated: [3.5, 7], Chaotic: [0, 1.5],  Clear: [7, 10] },
            "How predictable are the outcomes?":                    { Complex: [1.5, 3.5],Complicated: [3.5, 7], Chaotic: [0, 1.5],  Clear: [7, 10] },
            "How much historical data is available?":               { Complex: [1.5, 3.5],Complicated: [3.5, 7], Chaotic: [0, 1.5],  Clear: [7, 10] },
            "How frequently do unexpected outcomes occur?":         { Complex: [6.5, 9],  Complicated: [3, 6.5], Chaotic: [0, 3],    Clear: [6.5, 10] }, // Updated
            "How well understood are the system boundaries?":        { Complex: [1.5, 3.5],Complicated: [3, 7],   Chaotic: [0, 1.5],  Clear: [7, 10] },
            "How consistent are results when repeating actions?":   { Complex: [1.5, 5],  Complicated: [5, 9],   Chaotic: [0, 1.5],  Clear: [9, 10] }
        };
        const STAKEHOLDER_ALIGNMENT_QUESTION_TEXT = "How aligned are stakeholders?";

        document.addEventListener('DOMContentLoaded', function() {
            if (typeof cynefinQuestionsData === 'undefined' || typeof window.assessmentUtils === 'undefined') { // Removed cynefinDomainData check
                console.error("Core data or utility objects are not defined. Page functionality will be limited.");
                return; 
            }

            const cynefinPanelsWrapperId = 'cynefin-question-panels-wrapper';

            const decisionScoreBoxHtml = `
                <div class="score-box">
                    <div>Avg. Decision Making Score</div>
                    <div class="score-value" id="decision-score-avg">0.0</div>
                </div>`;
            
            const causeEffectScoreBoxHtml = `
                <div class="score-box">
                    <div>Avg. Cause-and-Effect Score</div>
                    <div class="score-value" id="cause-effect-score-avg">0.0</div>
                </div>`;

            new QuestionSectionComponent({
                parentElementId: cynefinPanelsWrapperId,
                panelId: 'decision-panel', // For tabbed interface
                isActivePanel: true,       // First panel is active
                sectionTitle: 'Decision Making Factors',
                titleTag: 'div', // To use .group-title styling
                titleIsGroupTitle: true,
                questionsContainerId: 'decision-questions-container',
                questionsData: cynefinQuestionsData.decision,
                questionGroupName: 'decision',
                sliderStep: "0.5",
                scoreBoxHtml: decisionScoreBoxHtml,
                // No nextButtonConfig for Cynefin panels initially, can be added if desired
            });

            new QuestionSectionComponent({
                parentElementId: cynefinPanelsWrapperId,
                panelId: 'cause-effect-panel', // For tabbed interface
                sectionTitle: 'Cause-and-Effect Relationship Factors',
                titleTag: 'div',
                titleIsGroupTitle: true,
                questionsContainerId: 'cause-effect-questions-container',
                questionsData: cynefinQuestionsData.causeEffect,
                questionGroupName: 'causeEffect',
                sliderStep: "0.5",
                scoreBoxHtml: causeEffectScoreBoxHtml,
                // No nextButtonConfig for Cynefin panels initially
            });

            // Panel navigation logic for Cynefin
            const cynefinSteps = document.querySelectorAll('.stacey-progress-tracker .step'); // Assuming reuse of class
            const cynefinPanels = document.querySelectorAll('#cynefin-question-panels-wrapper .question-panel');

            cynefinSteps.forEach(step => {
                step.addEventListener('click', function() {
                    cynefinSteps.forEach(s => s.classList.remove('active'));
                    cynefinPanels.forEach(p => {
                        p.classList.remove('active');
                        // The .section div is inside the .question-panel
                        // If QuestionSectionComponent wraps its output in a .section, that's fine.
                        // If not, and .question-panel itself is the one to show/hide, this is correct.
                    });

                    this.classList.add('active');
                    const panelId = this.getAttribute('data-panel-id');
                    const activePanel = document.getElementById(panelId);
                    if (activePanel) {
                        activePanel.classList.add('active');
                    }
                });
            });
            
            document.querySelectorAll('.slider').forEach(slider => {
                slider.addEventListener('input', function() {
                    assessmentUtils.updateSliderValueDisplay(this);
                    updateResults();
                });
            });
              document.getElementById('save-btn').addEventListener('click', saveResults);
            document.getElementById('reset-btn').addEventListener('click', resetForm);
            document.getElementById('test-complex-btn').addEventListener('click', setAnswersForComplexTest);
            document.getElementById('test-complicated-btn').addEventListener('click', setAnswersForComplicatedTest);
            
            loadSavedData();
            updateResults(); 
        });

        function getAllQuestionScores() {
            const scores = {};
            if (!cynefinQuestionsData || !cynefinQuestionsData.decision || !cynefinQuestionsData.causeEffect) {
                console.error("cynefinQuestionsData is not properly defined in getAllQuestionScores.");
                return scores;
            }

            [...cynefinQuestionsData.decision, ...cynefinQuestionsData.causeEffect].forEach(question => {
                if (!question || !question.id || !question.text) {
                    console.warn("Skipping invalid question object in getAllQuestionScores:", question);
                    return;
                }
                const slider = document.getElementById(`slider-${question.id}`);
                if (slider) {
                    scores[question.text] = parseFloat(slider.value);
                } else {
                    scores[question.text] = 0; 
                }
            });
            return scores;
        }

        function updateResults() {
            if (!cynefinQuestionsData) {
                 console.error("cynefinQuestionsData is not available in updateResults.");
                return;
            }
            const allScores = getAllQuestionScores();

            const decisionScoresArray = (cynefinQuestionsData.decision || []).map(q => allScores[q.text] !== undefined ? allScores[q.text] : 0);
            const causeEffectScoresArray = (cynefinQuestionsData.causeEffect || []).map(q => allScores[q.text] !== undefined ? allScores[q.text] : 0);

            const avgDecisionScore = decisionScoresArray.length > 0 ? decisionScoresArray.reduce((a, b) => a + b, 0) / decisionScoresArray.length : 0;
            const avgCauseEffectScore = causeEffectScoresArray.length > 0 ? causeEffectScoresArray.reduce((a, b) => a + b, 0) / causeEffectScoresArray.length : 0;

            document.getElementById('decision-score-avg').textContent = avgDecisionScore.toFixed(1);
            document.getElementById('cause-effect-score-avg').textContent = avgCauseEffectScore.toFixed(1);
            
            const domain = determineDomain(allScores);
            document.getElementById('current-domain').textContent = domain;
            
            highlightCurrentDomain(domain);
            // updateDomainInfoDisplay(domain); // Section removed
        }

        function determineDomain(questionScores) {
            let domainCounts = { Complex: 0, Complicated: 0, Chaotic: 0, Clear: 0 };
            let stakeholderAlignmentScore = questionScores[STAKEHOLDER_ALIGNMENT_QUESTION_TEXT];

            if (typeof stakeholderAlignmentScore === 'undefined') {
                stakeholderAlignmentScore = 10; // Default to not trigger disorder if question is missing
            }

            for (const questionText in questionScores) {
                if (!questionScores.hasOwnProperty(questionText)) continue;

                const score = questionScores[questionText];
                const thresholds = questionDomainThresholds[questionText];
                if (thresholds) {
                    for (const domainName in thresholds) { 
                        if (!thresholds.hasOwnProperty(domainName)) continue;
                        const range = thresholds[domainName];
                        if (score >= range[0] && score <= range[1]) {
                            domainCounts[domainName]++;
                        }
                    }
                }
            }
            
            // Disorder Check 1: Stakeholder Alignment (as per PDF page 16)
            if (stakeholderAlignmentScore !== null && stakeholderAlignmentScore <= 3) {
                return "Disorder";
            }

            let maxCount = 0;
            for (const domainName in domainCounts) {
                if (domainCounts[domainName] > maxCount) {
                    maxCount = domainCounts[domainName];
                }
            }

            // Disorder Check 2: No domain scores above thresholds (as per PDF page 16)
            // This means if maxCount is 0, no question matched any primary domain's criteria.
            // Or if the highest count is very low (e.g., less than a certain number of questions matching).
            const MIN_MATCHES_FOR_DOMAIN = 3; // Arbitrary threshold: at least 3 questions should match for a domain to be strongly considered.
            if (maxCount < MIN_MATCHES_FOR_DOMAIN) { 
                 return "Disorder";
            }

            const winningDomains = [];
            for (const domainName in domainCounts) {
                if (domainCounts[domainName] === maxCount) {
                    winningDomains.push(domainName);
                }
            }

            if (winningDomains.length === 0) return "Disorder"; // Should ideally not be reached if maxCount >= MIN_MATCHES_FOR_DOMAIN
            if (winningDomains.length === 1) return winningDomains[0];

            // Tie-breaking logic (as per PDF page 16)
            const priority = ["Chaotic", "Complex", "Complicated", "Clear"];
            for (const pDomain of priority) {
                if (winningDomains.includes(pDomain)) {
                    return pDomain;
                }
            }
            
            return "Disorder"; // Fallback
        }

        function highlightCurrentDomain(domain) {
            document.querySelectorAll('.quadrant').forEach(quad => {
                quad.classList.remove('highlighted');
            });
            
            const disorderElement = document.getElementById('disorder');
            const currentDomainId = domain.toLowerCase();

            if (currentDomainId === "disorder") {
                if (disorderElement) {
                    disorderElement.classList.add('highlighted');
                    disorderElement.style.display = 'flex'; 
                }
            } else {
                if (disorderElement) disorderElement.style.display = 'none';
                const domainElement = document.getElementById(currentDomainId);
                if (domainElement) {
                    domainElement.classList.add('highlighted');
                }
            }
        }

        function updateDomainInfoDisplay(domain) { 
            const infoElement = document.getElementById('domain-info');
            // This function is now primarily handled by summary.html which fetches the JSON.
            // If Cynefin.html needs to display this info, it would also need to fetch results-descriptions.json
            // For now, we assume this detailed display is only on summary.html.
                // if (infoElement) infoElement.style.display = 'none'; // Guard against null
 
            const data = cynefinDomainData[domain.toLowerCase()];
            
            // const domainTitleEl = document.getElementById('domain-title');
            // const domainSubtitleEl = document.getElementById('domain-subtitle');
            // const domainApproachTextEl = document.getElementById('domain-approach-text');
            // const domainConstraintEl = document.getElementById('domain-constraint-coupling');
            // const domainPracticeTypeEl = document.getElementById('domain-practice-type');
            // const characteristicsListEl = document.getElementById('domain-characteristics');
            // const stepsListEl = document.getElementById('domain-steps');

            // Clear previous content
            // domainTitleEl.textContent = '';
            // domainSubtitleEl.textContent = '';
            // domainApproachTextEl.textContent = '';
            // domainConstraintEl.textContent = '';
            // domainPracticeTypeEl.textContent = '';
            // characteristicsListEl.innerHTML = '';
            // stepsListEl.innerHTML = '';

            if (data) {
                // domainTitleEl.textContent = data.name || domain;
                // domainSubtitleEl.textContent = data.subtitle || '';
                // domainApproachTextEl.textContent = data.approach || '';
                // domainConstraintEl.textContent = data.constraintCoupling || 'N/A';
                // domainPracticeTypeEl.textContent = data.practiceType || 'N/A';
                
                // (data.characteristics || []).forEach(char => {
                //     const li = document.createElement('li');
                //     li.textContent = char;
                //     characteristicsListEl.appendChild(li);
                // });
                
                // if (data.steps) {
                //     data.steps.forEach(step => {
                //         const li = document.createElement('li');
                //         li.textContent = step;
                //         stepsListEl.appendChild(li);
                //     });
                // }
                // infoElement.style.display = 'block'; // Element removed
            } else {
                // infoElement.style.display = 'none'; // Element removed
                // console.warn(`No description data found for domain: ${domain}`);
            }
        }

        function saveResults() {
            if (typeof cynefinQuestionsData === 'undefined') {
                alert("Error: Question data is not loaded. Cannot save results.");
                return;
            }
            const allScores = getAllQuestionScores();
            const decisionScores = {};
            const causeEffectScores = {};

            (cynefinQuestionsData.decision || []).forEach(q => { decisionScores[q.text] = allScores[q.text] || 0; });
            (cynefinQuestionsData.causeEffect || []).forEach(q => { causeEffectScores[q.text] = allScores[q.text] || 0; });

            const results = {
                allQuestionScores: allScores,
                domain: document.getElementById('current-domain').textContent,
                averageDecisionScore: parseFloat(document.getElementById('decision-score-avg').textContent),
                averageCauseEffectScore: parseFloat(document.getElementById('cause-effect-score-avg').textContent),
                timestamp: new Date().toISOString()
            };
            
            window.assessmentUtils.saveToLocalStorage(CYNEFIN_LOCAL_STORAGE_KEY, results);
            alert('Results saved! Navigating to summary page.');
            // Replace "summary.html" with the actual next page URL if different
            window.location.href = "summary.html"; 
        }

        function loadSavedData() {
            const savedData = window.assessmentUtils.loadFromLocalStorage(CYNEFIN_LOCAL_STORAGE_KEY);
            if (savedData && savedData.allQuestionScores) {
                if (typeof cynefinQuestionsData === 'undefined') return;

                [...(cynefinQuestionsData.decision || []), ...(cynefinQuestionsData.causeEffect || [])].forEach(question => {
                     if (!question || !question.id || !question.text) return;
                     const slider = document.getElementById(`slider-${question.id}`);
                     const score = savedData.allQuestionScores[question.text];
                     if (slider && typeof score !== 'undefined') {
                         slider.value = score;
                         window.assessmentUtils.updateSliderValueDisplay(slider);
                     }
                });
            }
        }

        function resetForm() {
            window.assessmentUtils.resetAssessmentForm(CYNEFIN_LOCAL_STORAGE_KEY, () => {
                 document.querySelectorAll('.slider').forEach(slider => {
                    slider.value = slider.min || 0; 
                    window.assessmentUtils.updateSliderValueDisplay(slider); 
                });
                updateResults(); 
            });
        }

        // Test function to set sliders for Complex domain
        function setAnswersForComplexTest() {
            console.log("Setting answers for Complex domain test...");
            const targetScoresForComplex = {
                "How much experimentation is needed?": 7.5,    // Complex: 6.5-9
                "How much expert consensus exists?": 2.0,      // Complex: 1.5-3
                "How urgent is the need to act?": 6.0,         // Complex: 5-8 (using updated thresholds)
                "How often do novel aspects emerge?": 8.0,     // Complex: 7-9
                "How aligned are stakeholders?": 3.5,          // Complex: 1.5-3 (Setting to 3.5 to avoid Disorder override)
                "What is the tolerance for failure?": 2.5,     // Complex: 1.5-3
                "How clear are the cause-and-effect relationships?": 2.5, // Complex: 1.5-3.5
                "To what extent do best practices exist?": 2.5,            // Complex: 1.5-3.5
                "How predictable are the outcomes?": 2.5,                  // Complex: 1.5-3.5
                "How much historical data is available?": 2.5,             // Complex: 1.5-3.5
                "How frequently do unexpected outcomes occur?": 7.5,       // Complex: 6.5-9 (using updated thresholds)
                "How well understood are the system boundaries?": 2.5,      // Complex: 1.5-3.5
                "How consistent are results when repeating actions?": 3.0   // Complex: 1.5-5
            };

            if (!cynefinQuestionsData || !cynefinQuestionsData.decision || !cynefinQuestionsData.causeEffect) {
                console.error("cynefinQuestionsData is not available for the test function.");
                return;
            }

            [...cynefinQuestionsData.decision, ...cynefinQuestionsData.causeEffect].forEach(question => {
                if (!question || !question.id || !question.text) return;

                const slider = document.getElementById(`slider-${question.id}`);
                const targetScore = targetScoresForComplex[question.text];

                if (slider && targetScore !== undefined) {
                    slider.value = targetScore;
                    window.assessmentUtils.updateSliderValueDisplay(slider);
                } else if (targetScore === undefined) {
                    console.warn(`No target score defined for question: "${question.text}" in test function.`);
                } else {
                    console.warn(`Slider not found for question ID: slider-${question.id} (Text: ${question.text})`);
                }
            });

            updateResults(); // Update the domain and UI based on new slider values
            console.log("Complex domain test values set. Current domain:", document.getElementById('current-domain').textContent);
        }

        // Test function to set sliders for Complicated domain
        function setAnswersForComplicatedTest() {
            console.log("Setting answers for Complicated domain test...");
            const targetScoresForComplicated = {
                "How much experimentation is needed?": 5.0,
                "How much expert consensus exists?": 5.0,
                "How urgent is the need to act?": 4.0, // Complicated: 3-5
                "How often do novel aspects emerge?": 5.5,
                "How aligned are stakeholders?": 5.0, // Complicated: 3-7 (and >3)
                "What is the tolerance for failure?": 5.0,
                "How clear are the cause-and-effect relationships?": 5.0,
                "To what extent do best practices exist?": 5.0,
                "How predictable are the outcomes?": 5.0,
                "How much historical data is available?": 5.0,
                "How frequently do unexpected outcomes occur?": 5.0, // Complicated: 3-6.5
                "How well understood are the system boundaries?": 5.0,
                "How consistent are results when repeating actions?": 7.0
            };

            if (!cynefinQuestionsData || !cynefinQuestionsData.decision || !cynefinQuestionsData.causeEffect) {
                console.error("cynefinQuestionsData is not available for the Complicated test function.");
                return;
            }

            [...cynefinQuestionsData.decision, ...cynefinQuestionsData.causeEffect].forEach(question => {
                if (!question || !question.id || !question.text) return;

                const slider = document.getElementById(`slider-${question.id}`);
                const targetScore = targetScoresForComplicated[question.text];

                if (slider && targetScore !== undefined) {
                    slider.value = targetScore;
                    window.assessmentUtils.updateSliderValueDisplay(slider);
                } else if (targetScore === undefined) {
                    console.warn(`No target score defined for question: "${question.text}" in Complicated test function.`);
                } else {
                    console.warn(`Slider not found for question ID: slider-${question.id} (Text: ${question.text})`);
                }
            });

            updateResults();
            console.log("Complicated domain test values set. Current domain:", document.getElementById('current-domain').textContent);
        }

    </script>
    <script src="JavaScript/question-section-component.js"></script>
    <script src="JavaScript/assessment-utils.js"></script>    
</body>
</html>
